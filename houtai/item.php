<?php
//Copyright (c) 2016 iFeiwu.com
 class Item extends Ifeiwu { public function __construct() { goto x3jm3; x3jm3: if ($this->table) { goto MV8x9; } goto QodPd; X9Sw_: MV8x9: goto U9akZ; QodPd: $this->table = "\151\x74\145\x6d"; goto X9Sw_; U9akZ: parent::__construct(); goto ZshnD; ZshnD: } protected function postPage($request_data) { goto vpbtW; Nkjbk: return $this->success($data); goto GEYEb; JIzPU: $column = $request_data["\143\x6f\154\165\x6d\x6e"] ?: "\x2a"; goto BNaOm; xE6Fw: $perpage = $request_data["\x70\x65\162\x70\x61\147\x65"] ?: 0; goto iNTEm; H5aCc: $data = array("\154\151\x73\164" => $list, "\x74\x6f\x74\x61\154" => $total, "\x70\145\162\160\x61\147\x65" => $perpage, "\x70\141\x67\145" => $page); goto dyc12; XTOKb: $data = $this->db->select($this->table, $column)->where($where)->order($order)->all(); goto KeJIg; aM3GD: $order = $request_data["\x6f\x72\x64\145\x72"] ?: $this->order; goto xE6Fw; r6ERI: $this->_callback("\143\141\x6c\154\142\x61\x63\153\120\141\147\145\x41\x66\164\145\162", array(&$data)); goto Nkjbk; HF181: $list = $this->db->select($this->table, $column)->where($where)->order($order)->limit(array($page * $perpage, $perpage))->all(); goto H5aCc; S4U7Z: O5n_W: goto Udncn; KeJIg: goto kvlbB; goto S4U7Z; Ui8F0: $page = $page ? $page - 1 : 0; goto hlw1e; BNaOm: $where = $request_data["\x77\150\x65\162\145"] ?: "\x31\40\75\x20\x31"; goto aM3GD; iNTEm: if ($perpage > 0) { goto O5n_W; } goto XTOKb; hlw1e: $total = $this->db->select($this->table)->where($where)->count(); goto HF181; dyc12: kvlbB: goto r6ERI; Udncn: $page = $request_data["\160\141\147\145"] ?: 1; goto Ui8F0; vpbtW: $this->_callback("\x63\141\154\x6c\x62\x61\143\153\x50\x61\x67\x65\x42\x65\146\x6f\162\145", array(&$request_data)); goto JIzPU; GEYEb: } protected function postQuery($request_data) { goto wFpUw; KOXJ0: if (!(stripos($sql, "\44\x74\141\x62\154\145") !== false)) { goto zO3eW; } goto DQBLu; DQBLu: $sql = str_replace("\x24\x74\x61\x62\154\x65", $this->prefix . $this->table, $sql); goto Oun_N; yShvh: return $this->db->query($sql, $request_data["\x76\141\154\x75\145\163"])->all(); goto KUMuz; wFpUw: $sql = $request_data["\163\161\x6c"]; goto KOXJ0; Oun_N: zO3eW: goto yShvh; KUMuz: } protected function getOne($id, $column = null) { goto ZUMbI; GY3NX: return $this->success($data); goto A0XcT; xqNoO: $data = $this->db->select($this->table, $column)->where(array("\x69\144", "\75", $id))->get(); goto GY3NX; ZUMbI: $column = $column ?: "\52"; goto xqNoO; A0XcT: } protected function postAdd($request_data) { goto SWmRy; PzmaI: $upload_path = $request_data["\x24\165\160\x6c\x6f\x61\144\137\x70\x61\x74\150"]; goto egLgK; cNTmH: jtLrj: goto oIjI7; hpbyO: if (!($pid > 0 && in_array("\x6c\x65\166\145\154", $this->fields))) { goto jtLrj; } goto xpFMk; yfB6c: $this->db->beginTransaction(); goto xqNXV; d4aox: if ($id) { goto XpZQR; } goto pe1Ze; YvKic: $this->_callback("\143\x61\154\x6c\142\141\x63\153\x41\x64\x64\x41\x66\x74\x65\x72", array($id, &$request_data)); goto Xqkx7; eqry7: $pid = $data["\160\151\x64"]; goto hpbyO; W6T5j: if ($this->db->update($this->table, $udata, array("\151\x64", "\x3d", $id))->is()) { goto HAO6E; } goto ncKhR; xpFMk: $udata["\154\x65\x76\x65\154"] = $this->_getLevel($pid, $id); goto cNTmH; xqNXV: $id = $this->db->insert($this->table, $data)->id(); goto d4aox; vgsF6: $data["\x69\144"] = $id; goto NJgkl; Y0RRs: $udata = array("\x69\x64" => $id); goto eqry7; NJgkl: $upload_path = $this->_bulidUploadPath($upload_path, $data); goto SCrIu; UPr6Q: goto Bapwu; goto uZJ1j; NSlWd: $this->_removeFiles2($request_data["\x5f\162\x65\x6d\157\x76\x65\x66\x69\154\x65\163"]); goto NxH2t; xmOyT: $this->db->commit(); goto nD0de; SWmRy: $this->_callback("\x63\141\154\154\142\x61\x63\153\101\x64\x64\x42\x65\146\x6f\x72\145", array(&$request_data)); goto NSlWd; ncKhR: $this->db->rollBack(); goto LcC_I; Xqkx7: $this->_log("\x61\144\144", array("\x74\x69\x74\154\x65" => $data["\164\x69\x74\x6c\x65"], "\164\141\x62\154\145\137\x69\x64" => $id)); goto xmOyT; oIjI7: $upload_name = $request_data["\x24\x75\160\x6c\x6f\x61\x64\x5f\156\141\x6d\145"]; goto PzmaI; LcC_I: return $this->error("\xe6\xb7\273\345\x8a\240\xe6\x95\260\xe6\x8d\xae\xe5\244\xb1\350\xb4\xa5\357\xbc\201"); goto UPr6Q; B57Rl: GA2zV: goto W6T5j; pe1Ze: return $this->error("\xe6\267\273\345\212\240\xe6\225\260\346\215\256\345\xa4\261\xe8\264\xa5\xef\274\201"); goto m1Oat; egLgK: if (!($upload_name && $upload_path)) { goto GA2zV; } goto vgsF6; nD0de: return $this->success("\346\xb7\xbb\345\x8a\xa0\346\225\xb0\xe6\x8d\xae\xe6\210\x90\345\212\x9f\xef\xbc\201", array("\151\144" => $id, "\x69\x6d\x61\x67\145\137\x70\141\x74\x68" => $upload_path)); goto GRfrf; uZJ1j: HAO6E: goto YvKic; GRfrf: Bapwu: goto RC6VR; NxH2t: $data = $this->_bulidData($request_data); goto yZmEt; yZmEt: $data["\143\164\x69\155\x65"] = time(); goto yfB6c; SCrIu: $udata[$upload_name] = $upload_path; goto B57Rl; m1Oat: XpZQR: goto Y0RRs; RC6VR: } protected function postUpdate($id, $request_data) { goto R4IB5; EQvXt: if (!in_array($upload_name, $this->fields)) { goto fnBke; } goto n2WvS; wwNbo: $upload_path = $request_data["\44\165\x70\x6c\x6f\x61\144\137\160\141\164\x68"]; goto Dv7ue; Qg9iM: bHc8D: goto mEhe3; onABt: fnBke: goto ZbNsz; QxGhL: $this->_callback("\143\141\x6c\154\x62\x61\143\x6b\125\160\x64\141\164\x65\x41\146\x74\x65\162", array($id, &$request_data)); goto YPXw2; WiWWi: $data["\154\x65\166\x65\x6c"] = $this->_getLevel($pid, $id); goto Qg9iM; SOQYb: if (!($pid > 0 && in_array("\154\x65\166\x65\154", $this->fields))) { goto bHc8D; } goto WiWWi; ZbNsz: yAlhG: goto WX4aL; vh3TT: goto Jz0ZS; goto jZojN; R4IB5: $this->_callback("\x63\141\x6c\154\x62\141\x63\153\125\160\144\141\x74\145\102\x65\146\157\162\145", array(&$request_data)); goto BD1gN; RhV4m: return $this->error("\xe4\277\x9d\xe5\255\x98\xe5\xa4\xb1\xe8\264\xa5\357\xbc\201"); goto vh3TT; ePs5t: $upload_path = $this->_bulidUploadPath($upload_path, $data); goto EQvXt; n2WvS: $data[$upload_name] = $upload_path; goto onABt; WX4aL: if ($this->db->update($this->table, $data, array("\151\x64", "\x3d", $id))->is()) { goto kS1Mh; } goto RhV4m; jZojN: kS1Mh: goto QxGhL; F1AkI: Jz0ZS: goto AJBK6; mEhe3: $upload_name = $request_data["\x24\165\160\x6c\x6f\141\144\137\156\x61\155\x65"]; goto wwNbo; xHcTX: $data = $this->_bulidData($request_data); goto rE4z4; Dv7ue: if (!($upload_name && $upload_path)) { goto yAlhG; } goto ePs5t; oEil6: $pid = $data["\x70\151\x64"]; goto SOQYb; rE4z4: $data["\x75\x74\x69\x6d\x65"] = time(); goto oEil6; YPXw2: $this->_log("\165\x70\x64\141\x74\145", array("\x74\151\x74\x6c\145" => $data["\164\x69\164\154\x65"])); goto QJ6NF; QJ6NF: return $this->success("\xe5\xb7\262\xe4\277\235\345\xad\230\xe6\x9b\264\346\x94\271\357\274\x81"); goto F1AkI; BD1gN: $this->_removeFiles2($request_data["\x5f\x72\145\155\x6f\x76\145\146\x69\154\x65\163"]); goto xHcTX; AJBK6: } protected function postField($request_data) { goto aGcuX; aGcuX: $ids = $request_data["\151\x64"]; goto m4xtK; T8rHW: d91Jq: goto EDtYw; Ze7E6: return $this->success(); goto T8rHW; CTXl5: return $this->error(); goto R1uHC; m4xtK: $name = $request_data["\156\x61\x6d\145"]; goto gu6Jy; R1uHC: goto d91Jq; goto xPBn7; xPBn7: JFHJg: goto Ze7E6; ZE5FZ: if ($this->db->update($this->table, array($name => $value), array("\151\x64", "\x49\x4e", $ids))->is()) { goto JFHJg; } goto CTXl5; gu6Jy: $value = $request_data["\x76\141\x6c\x75\145"]; goto ZE5FZ; EDtYw: } protected function postCount($request_data) { goto MVOyZ; NH9Tt: $where = $request_data["\x77\x68\145\x72\145"] ?: "\x31\40\x3d\40\61"; goto F3GZ3; MVOyZ: $table = $request_data["\164\141\142\154\145"] ?: $this->table; goto NH9Tt; F3GZ3: return $this->db->select($table)->where($where)->count(); goto N9W57; N9W57: } protected function postDelete($request_data) { goto QbVjB; dWosi: cv_Ly: goto vfq9f; klbN0: $this->db->rollBack(); goto kklKh; QbVjB: $this->_callback("\143\x61\x6c\x6c\142\141\143\153\104\145\154\145\x74\145\x42\x65\146\x6f\162\145", array(&$request_data)); goto bz4GU; jMMb7: VvoVD: goto XY23F; XY23F: if (count($error) === 0) { goto cv_Ly; } goto klbN0; vfq9f: $this->_callback("\143\x61\154\154\142\141\143\153\x44\145\154\x65\x74\x65\101\x66\164\145\x72", array(&$request_data)); goto dmI0f; kklKh: return $this->error("\xe6\234\211\40" . count($error) . "\xe6\235\241\xe6\x95\xb0\346\215\256\345\x88\240\xe9\231\xa4\345\xa4\261\350\264\245\357\xbc\x81"); goto trHxl; jhXt3: TvLYJ: goto Q20bi; dmI0f: $this->db->commit(); goto riIjv; bz4GU: $error = array(); goto HPeft; KPnDm: return $this->success(); goto jhXt3; trHxl: goto TvLYJ; goto dWosi; HPeft: $ids = $request_data["\151\x64"]; goto mpqnZ; riIjv: $this->_log("\x72\x65\x6d\x6f\166\x65", array("\x74\151\164\x6c\145" => count($ids))); goto KPnDm; mpqnZ: $this->db->beginTransaction(); goto D33uc; D33uc: foreach ($ids as $id) { goto ijESC; wA78j: pd5d2: goto B1cSB; t21mF: $error[] = $id; goto ixx8u; XyuHI: goto Uo5Rc; goto I2ZSc; I2ZSc: oY2hN: goto gqthS; ijESC: $item = $this->db->select($this->table)->where(array("\x69\x64", "\75", $id))->get(); goto ZVu0T; ixx8u: goto pd5d2; goto XyuHI; ZVu0T: if ($this->db->delete($this->table, array("\x69\144", "\x3d", $id))->is()) { goto oY2hN; } goto t21mF; mB5cd: Uo5Rc: goto wA78j; gqthS: $this->_trash($item, $request_data); goto mB5cd; B1cSB: } goto jMMb7; Q20bi: } }
