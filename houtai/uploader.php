<?php
//Copyright (c) 2016 iFeiwu.com
 class Uploader extends Ifeiwu { function __construct() { } protected function postImage($request_data) { goto YxiKV; pg_va: if (!($file_save_path == "\x2f")) { goto DKW1h; } goto i8aZj; ycro1: cm5ej: goto fyGHl; XMWge: goto vLgPU; goto bIxRy; xbdCa: goto cm5ej; goto aunJQ; WLO2O: nXtz8: goto VDDQ1; VDDQ1: $handle->file_overwrite = $file_overwrite ? true : false; goto cr2iv; oN2AN: $handle = new Upload($_FILES["\x66\x69\x6c\145"]); goto IrjWD; PoKYi: return $this->error("\346\x97\240\xe6\x95\210\347\x9a\204\346\x96\x87\344\xbb\266\xe4\xbf\241\346\201\xaf\357\274\x81"); goto XMWge; DKLOB: $upload_root = "\x2e\x2e\57"; goto Ti1s_; R_D1D: vLgPU: goto eUO3k; K_fyy: $image_convert = $_POST["\151\x6d\x61\x67\145\x5f\x63\x6f\x6e\x76\x65\x72\x74"]; goto U59T4; dph1m: $image_x = explode("\54", $_POST["\151\155\141\147\145\x5f\x78"]); goto tnY9O; ZK5Dx: if (!$quality) { goto I404T; } goto FOg8u; ZvdKj: I404T: goto QH_VE; FOg8u: $handle->jpeg_quality = $quality; goto ZvdKj; M7SuX: $file_name_body_pre = explode("\x2c", $_POST["\x66\x69\154\145\137\x6e\141\155\145\137\142\157\144\x79\137\x70\162\145"]); goto dph1m; fyGHl: vB17s: goto pXVd4; wdtyx: $handle->file_new_name_body = $file_new_name_body; goto WLO2O; i8aZj: $file_save_path = ''; goto J6IUq; UTlwr: foreach ($file_name_body_pre as $key => $prefix) { goto O2dwM; io6SQ: if ($width && $handle->image_src_x > $width) { goto ooBbZ; } goto EFYty; HEbPJ: JNDDs: goto RwH0g; ElnIo: if (!$image_convert) { goto QNmqC; } goto sJvDH; y2Y4M: KR23Y: goto cPrQN; RwH0g: $handle->file_overwrite = $file_overwrite ? true : false; goto hPuqg; FvwXV: GkYXu: goto mV0mL; ZKc2t: $handle->jpeg_quality = $quality; goto borO4; qpEOW: $handle->image_ratio_y = true; goto Lnafq; EFYty: $handle->image_x = $handle->image_src_x; goto qDWwK; cPrQN: if ($height && $handle->image_src_y > $height) { goto GkYXu; } goto qpEOW; kmYpy: $handle->file_new_name_body = $file_new_name_body; goto HEbPJ; nGLKH: if (!$prefix) { goto hQ2dg; } goto UBv3b; O2dwM: $width = $image_x[$key]; goto bDbev; UBv3b: $handle->image_resize = $image_resize ? true : false; goto PuFAB; AOpW2: $quality = $jpeg_quality[$key]; goto nGLKH; b1xBv: QNmqC: goto io6SQ; TE29E: ooBbZ: goto owPVZ; PuFAB: $handle->file_name_body_pre = $prefix; goto ROILq; cipAH: if (!$quality) { goto Lhwkj; } goto ZKc2t; iXESQ: xmf4H: goto yrUrd; SNzSK: LJkFz: goto oKtf0; owPVZ: $handle->image_x = $width; goto y2Y4M; qDWwK: goto KR23Y; goto TE29E; bDbev: $height = $image_y[$key]; goto AOpW2; ROILq: hQ2dg: goto cipAH; borO4: Lhwkj: goto ElnIo; oKtf0: if (!$file_new_name_body) { goto JNDDs; } goto kmYpy; sJvDH: $handle->image_convert = $image_convert; goto b1xBv; Lnafq: goto LJkFz; goto FvwXV; mV0mL: $handle->image_y = $height; goto SNzSK; hPuqg: $handle->Process($upload_root . "\x2f" . $file_save_path); goto iXESQ; yrUrd: } goto KKbAB; cr2iv: $handle->Process($upload_root . "\57" . $file_save_path); goto xbdCa; z8u98: $image_resize = $_POST["\x69\x6d\x61\147\x65\137\x72\x65\163\151\x7a\x65"]; goto fL8PT; QH_VE: if (!$image_convert) { goto mB2dS; } goto gyude; nuCwU: if ($image_resize == 1) { goto S_YMO; } goto zlHMS; aunJQ: S_YMO: goto M7SuX; LR_PV: return $this->error($handle->log); goto e0HpA; VDOdX: $_FILES["\x66\x69\x6c\x65"]["\164\171\160\145"] = $_POST["\146\x69\154\x65\137\164\171\x70\145"]; goto aM1Fz; UmFwh: $_FILES["\146\x69\154\x65"]["\x65\x72\x72\157\162"] = $_POST["\x66\151\154\145\137\145\162\162\x6f\x72"]; goto zwQWE; ZDDlN: if (!$file_new_name_body) { goto nXtz8; } goto wdtyx; yHtQd: mB2dS: goto ZDDlN; U59T4: $jpeg_quality = explode("\x2c", $_POST["\152\160\x65\147\137\161\x75\141\x6c\x69\x74\x79"]); goto nuCwU; AhBl7: YjrBD: goto R_D1D; bIxRy: AZwtV: goto Pgqsj; tnY9O: $image_y = explode("\x2c", $_POST["\x69\x6d\141\147\145\x5f\171"]); goto UTlwr; uMjk2: $file_overwrite = $_POST["\x66\151\154\145\x5f\x6f\x76\x65\x72\x77\x72\151\164\x65"]; goto z8u98; pXVd4: if ($handle->processed) { goto DPZSJ; } goto LR_PV; YxiKV: $_FILES["\x66\x69\154\145"]["\x6e\x61\x6d\x65"] = $_POST["\x66\151\154\145\x5f\156\x61\x6d\145"]; goto VDOdX; aM1Fz: $_FILES["\x66\x69\154\x65"]["\x73\151\x7a\145"] = $_POST["\146\x69\x6c\x65\137\x73\x69\x7a\145"]; goto UmFwh; Ti1s_: $file_new_name_body = $_POST["\146\151\x6c\x65\137\x6e\x65\167\x5f\156\141\x6d\x65\137\x62\x6f\x64\171"]; goto uMjk2; zwQWE: if (!empty($_FILES["\x66\151\x6c\x65"])) { goto AZwtV; } goto PoKYi; zlHMS: $quality = end($jpeg_quality); goto ZK5Dx; J6IUq: DKW1h: goto EjmJv; EjmJv: return $this->success('', array("\160\x61\164\150" => $file_save_path, "\x69\x6d\x61\x67\x65" => $handle->file_dst_name, "\163\151\172\x65" => $handle->file_src_size, "\167\151\x64\164\150" => $handle->image_src_x, "\150\x65\151\x67\150\164" => $handle->image_src_y, "\164\x79\160\x65" => $handle->image_dst_type, "\145\170\164" => $handle->file_dst_name_ext)); goto AhBl7; Pgqsj: ifeiwu\Loader::import("\x65\x78\164\145\156\x64\x2f\125\160\x6c\157\x61\144"); goto oN2AN; e0HpA: goto YjrBD; goto AmKtP; KKbAB: iP6iZ: goto ycro1; AmKtP: DPZSJ: goto pg_va; IrjWD: if (!$handle->uploaded) { goto vB17s; } goto DKLOB; fL8PT: $file_save_path = $_POST["\x66\151\154\x65\137\x73\x61\x76\x65\137\160\x61\164\150"]; goto K_fyy; gyude: $handle->image_convert = $image_convert; goto yHtQd; eUO3k: } protected function postFile($request_data) { goto jnfu8; AWELZ: if (is_dir($temp_dir)) { goto eaTGT; } goto c0DNr; pRKqr: kFFLz: goto oC_8T; iXwvX: $_FILES["\146\151\154\145"]["\x73\151\172\145"] = $_POST["\146\151\154\145\137\x73\151\x7a\145"]; goto ybIL8; jnfu8: $save_path = "\56\56\57" . $this->_UTF82GBK($_POST["\x73\x61\166\x65\x5f\x70\x61\164\150"]); goto GT2KX; oC_8T: $this->_debug("\105\162\x72\x6f\x72\40\163\141\x76\x69\x6e\x67\40\50\x6d\157\x76\x65\137\165\x70\154\157\x61\x64\145\144\137\146\151\x6c\x65\51\40\143\150\165\x6e\x6b\x20" . $resumableChunkNumber . "\40\146\x6f\162\x20\x66\x69\154\x65\40" . $resumableFilename); goto UUA6j; ybIL8: $_FILES["\x66\x69\154\145"]["\x65\x72\162\157\162"] = $_POST["\146\x69\x6c\x65\137\x65\x72\162\x6f\x72"]; goto iFgJn; iFgJn: $file = $_FILES["\146\x69\x6c\x65"]; goto A_jwI; Qwdm5: $resumableIdentifier = $_POST["\162\x65\163\x75\x6d\141\142\x6c\145\111\144\145\x6e\x74\151\x66\x69\145\162"]; goto gpB4u; vYiXM: eaTGT: goto q1gF4; q1gF4: if (!move_uploaded_file($file["\164\x6d\160\x5f\156\141\155\145"], $dest_file)) { goto kFFLz; } goto FxkZw; yLzPf: $_FILES["\x66\x69\x6c\x65"]["\164\x79\x70\x65"] = $_POST["\x66\x69\x6c\145\x5f\x74\x79\160\145"]; goto iXwvX; A_jwI: if (!($file["\x65\162\162\157\x72"] != 0)) { goto COuoy; } goto Xmyo1; c0DNr: mkdir($temp_dir, 511, true); goto vYiXM; RGAK6: $temp_dir = $save_path . "\57" . $resumableIdentifier; goto nRt5e; lzgBM: COuoy: goto RGAK6; FxkZw: $this->_createFileFromChunks($save_path, $temp_dir, $resumableFilename, $_POST["\x72\145\163\x75\x6d\141\142\154\x65\x43\150\x75\156\153\x53\x69\x7a\x65"], $_POST["\x72\x65\x73\165\x6d\x61\142\154\145\124\x6f\164\141\x6c\x53\151\172\145"]); goto Hy1Dj; GT2KX: $resumableFilename = $this->_UTF82GBK($_POST["\162\145\x73\x75\155\141\142\x6c\145\x46\x69\x6c\x65\156\141\155\145"]); goto oFTj6; nRt5e: $dest_file = $temp_dir . "\57" . $resumableFilename . "\56\160\x61\x72\x74" . $resumableChunkNumber; goto AWELZ; Xmyo1: $this->_debug("\x65\x72\x72\x6f\162\40" . $file["\x65\162\x72\x6f\162"] . "\x20\151\x6e\40\146\x69\x6c\145\x20" . $resumableFilename); goto lzgBM; Hy1Dj: goto lOcTo; goto pRKqr; gpB4u: $_FILES["\146\x69\154\145"]["\x6e\x61\155\x65"] = $_POST["\146\x69\154\145\x5f\x6e\x61\x6d\145"]; goto yLzPf; UUA6j: lOcTo: goto aCvRB; oFTj6: $resumableChunkNumber = $_POST["\162\145\x73\x75\155\141\142\x6c\x65\103\150\x75\x6e\153\116\165\x6d\142\x65\162"]; goto Qwdm5; aCvRB: } protected function getFile() { goto dn3mI; XKGH3: $chunk_file = $temp_dir . "\x2f" . $resumableFilename . "\56\160\x61\x72\x74" . $resumableChunkNumber; goto JDswZ; Szvqt: goto pRBFG; goto Nyq6A; gxJky: return 202; goto nXmWu; JDswZ: if (file_exists($chunk_file)) { goto bcPYq; } goto I4KWN; Nyq6A: bcPYq: goto gxJky; aZpya: $resumableFilename = $this->_UTF82GBK($_GET["\x72\x65\163\x75\x6d\141\142\154\145\x46\x69\154\145\x6e\x61\x6d\145"]); goto gZi1y; nXmWu: pRBFG: goto yt5pa; ZJXu2: $resumableIdentifier = $_GET["\162\145\163\x75\x6d\141\142\x6c\145\111\x64\x65\x6e\x74\151\146\x69\x65\x72"]; goto IZ8e2; dn3mI: $save_path = "\56\x2e\57" . $this->_UTF82GBK($_GET["\x73\141\166\145\137\x70\141\x74\150"]); goto aZpya; IZ8e2: $temp_dir = $save_path . "\x2f" . $resumableIdentifier; goto XKGH3; I4KWN: return 404; goto Szvqt; gZi1y: $resumableChunkNumber = $_GET["\x72\x65\x73\x75\155\x61\x62\154\x65\x43\x68\165\x6e\153\x4e\165\155\142\145\x72"]; goto ZJXu2; yt5pa: } private function _createFileFromChunks($save_path, $temp_dir, $fileName, $chunkSize, $totalSize) { goto SU6OA; ck_t9: fclose($fp); goto ikPEO; N61j0: CD5Vo: goto ck_t9; XjEM2: quFBy: goto HvwdW; en6gP: if (($fp = fopen($save_path . "\57" . $fileName, "\167")) !== false) { goto hUOO5; } goto ZtHQv; rDCes: $i++; goto OYW7d; HvwdW: if (!($total_files * $chunkSize >= $totalSize - $chunkSize + 1)) { goto MFY6e; } goto en6gP; Lz21a: $this->_rrmdir($temp_dir . "\x5f\125\116\x55\123\x45\104"); goto hsy1J; Tn9GY: MFY6e: goto NbjfI; QZNdv: fwrite($fp, file_get_contents($temp_dir . "\x2f" . $fileName . "\x2e\x70\x61\162\x74" . $i)); goto NmTVS; Q7_Kj: $i = 1; goto mRrp0; mRrp0: U9CIn: goto IVupa; IVupa: if (!($i <= $total_files)) { goto CD5Vo; } goto QZNdv; w14va: goto MksFR; goto aEp4j; ZtHQv: $this->_debug("\x63\141\x6e\156\x6f\164\40\143\x72\145\x61\x74\x65\x20\164\x68\145\40\x64\x65\x73\164\151\156\141\164\x69\x6f\x6e\x20\146\151\x6c\145"); goto vOoCt; z4B9q: j3aXR: goto Lz21a; NmTVS: Ab2yb: goto rDCes; hsy1J: QNrVr: goto Tn9GY; SU6OA: $total_files = 0; goto gOwmh; GiIyA: $this->_rrmdir($temp_dir); goto lidwD; ikPEO: MksFR: goto rhZMK; rhZMK: if (rename($temp_dir, $temp_dir . "\137\x55\116\125\x53\x45\104")) { goto j3aXR; } goto GiIyA; aEp4j: hUOO5: goto Q7_Kj; gOwmh: foreach (scandir($temp_dir) as $file) { goto ZXlZJ; ZXlZJ: if (!(stripos($file, $fileName) !== false)) { goto JF0SO; } goto Vyw4I; FidfV: JF0SO: goto OBEBN; Vyw4I: $total_files++; goto FidfV; OBEBN: Same2: goto xID8_; xID8_: } goto XjEM2; lidwD: goto QNrVr; goto z4B9q; OYW7d: goto U9CIn; goto N61j0; vOoCt: return false; goto w14va; NbjfI: } private function _rrmdir($dir) { goto VTir3; VTir3: if (!is_dir($dir)) { goto Tqs5l; } goto Wfukf; S1E0b: foreach ($objects as $object) { goto u1TN1; WMPPq: DgoUY: goto j7MN1; j7MN1: czBvS: goto D1yuL; TCtU7: goto DgoUY; goto op4cc; KBSyn: unlink($dir . "\57" . $object); goto TCtU7; u1TN1: if (!($object != "\56" && $object != "\56\x2e")) { goto czBvS; } goto hQaxC; H_TEw: $this->_rrmdir($dir . "\57" . $object); goto WMPPq; op4cc: VymD8: goto H_TEw; hQaxC: if (filetype($dir . "\x2f" . $object) == "\144\151\162") { goto VymD8; } goto KBSyn; D1yuL: muNrZ: goto w3yow; w3yow: } goto WAT61; Nv1eQ: reset($objects); goto iglfJ; O9fsp: Tqs5l: goto p1jw0; Wfukf: $objects = scandir($dir); goto S1E0b; WAT61: VyLqb: goto Nv1eQ; iglfJ: rmdir($dir); goto O9fsp; p1jw0: } }
